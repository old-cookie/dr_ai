import 'package:flutter/foundation.dart';

/// 演示模式服務類
/// 提供預定義的醫療諮詢回答，用於應用離線演示或測試
class DemoService {
  /// 處理演示模式下的消息
  /// 根據用戶輸入關鍵詞提供預定義的回答
  /// @param message 用戶輸入的消息
  static Future<String> processDemoMessage(String message) async {
    // 將消息轉為小寫以便不區分大小寫進行匹配
    String lowerMessage = message.toLowerCase();
    
    // 檢查各種症狀關鍵詞並提供相應回答
    if (lowerMessage.contains("頭痛") || lowerMessage.contains("頭疼")) {
      return "**頭痛可能原因**:\n\n"
            "1. 壓力和緊張\n"
            "2. 脫水\n"
            "3. 睡眠不足\n"
            "4. 眼睛疲勞\n"
            "5. 感冒或鼻竇感染\n\n"
            "**自我照顧建議**:\n"
            "- 適當休息\n"
            "- 補充水分\n"
            "- 冷敷或熱敷頭部\n"
            "- 保持規律作息\n\n"
            "**應尋求專業幫助的情況**:\n"
            "若頭痛非常嚴重、突然發作、伴隨發燒或頸部僵硬，建議立即就醫。";
    } 
    else if (lowerMessage.contains("發燒") || lowerMessage.contains("體溫")) {
      return "**發燒可能原因**:\n\n"
            "1. 病毒感染(如感冒、流感)\n"
            "2. 細菌感染\n"
            "3. 炎症反應\n\n"
            "**自我照顧建議**:\n"
            "- 多休息，多喝水\n"
            "- 使用退燒藥（如普拿疼）\n"
            "- 穿著輕便衣物\n"
            "- 室溫保持涼爽\n\n"
            "**應尋求專業幫助的情況**:\n"
            "成人體溫超過39°C、持續超過3天，或伴隨嚴重頭痛、呼吸困難等症狀時，請立即就醫。";
    }
    else if (lowerMessage.contains("咳嗽")) {
      return "**咳嗽可能原因**:\n\n"
            "1. 上呼吸道感染\n"
            "2. 過敏\n"
            "3. 哮喘\n"
            "4. 胃酸倒流\n\n"
            "**自我照顧建議**:\n"
            "- 多喝溫水\n"
            "- 使用蜂蜜水緩解喉嚨不適\n"
            "- 避免刺激性食物和煙霧\n"
            "- 保持室內濕度\n\n"
            "**應尋求專業幫助的情況**:\n"
            "咳嗽持續超過2週、有血絲、伴隨胸痛或呼吸困難時，建議就醫。";
    }
    else if (lowerMessage.contains("感冒") || lowerMessage.contains("流感")) {
      return "**感冒/流感處理建議**:\n\n"
            "1. 多休息，保持充分睡眠\n"
            "2. 多喝溫水，保持體內水分\n"
            "3. 可使用成藥如普拿疼緩解症狀\n"
            "4. 使用鹽水漱口緩解喉嚨痛\n\n"
            "**預防措施**:\n"
            "- 勤洗手\n"
            "- 避免接觸病患\n"
            "- 加強免疫系統\n\n"
            "**應尋求專業幫助的情況**:\n"
            "高燒不退、呼吸困難、胸痛或症狀持續惡化時，請立即就醫。";
    }
    else if (lowerMessage.contains("腹痛") || lowerMessage.contains("肚子痛")) {
      return "**腹痛可能原因**:\n\n"
            "1. 消化不良\n"
            "2. 食物中毒\n"
            "3. 胃腸炎\n"
            "4. 便秘\n"
            "5. 腸躁症\n\n"
            "**自我照顧建議**:\n"
            "- 少量多餐\n"
            "- 避免油膩、辛辣食物\n"
            "- 喝足夠的水\n"
            "- 溫敷腹部\n\n"
            "**應尋求專業幫助的情況**:\n"
            "嚴重腹痛、持續嘔吐、排便帶血或症狀迅速惡化時，請立即就醫。";
    }
    else {
      // 默認回覆
      return "感謝您的提問。這是演示模式的回答。\n\n"
            "我能識別一些常見的健康問題關鍵詞，如「頭痛」、「發燒」、「咳嗽」、「感冒」和「腹痛」。\n\n"
            "請嘗試包含這些關鍵詞的問題，我將提供相應的健康建議。\n\n"
            "請注意：這只是演示功能，提供的資訊僅供參考，不能替代專業醫療建議。";
    }
  }
  
  /// 檢查是否為演示模式
  /// @return 是否啟用演示模式
  static bool isDemoMode() {
    try {
      // 這裡需要通過依賴注入或其他方式獲取設置
      // 目前暫時返回false，應在實際使用時改為從prefs獲取
      return false;
    } catch (e) {
      debugPrint('檢查演示模式時出錯: $e');
      return false;
    }
  }
}
